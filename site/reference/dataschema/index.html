
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.2">
    
    
      
        <title>dataschema - mercury-dataschema</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-schema" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="mercury-dataschema" class="md-header__button md-logo" aria-label="mercury-dataschema" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mercury-dataschema
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              dataschema
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/BBVA/mercury-dataschema/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-dataschema
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="mercury-dataschema" class="md-nav__button md-logo" aria-label="mercury-dataschema" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 2-5 4.5v11l5-4.5zM6.5 5C4.55 5 2.45 5.4 1 6.5v14.66c0 .25.25.5.5.5.1 0 .15-.07.25-.07 1.35-.65 3.3-1.09 4.75-1.09 1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.31 4.75 1.06.1.05.15.03.25.03.25 0 .5-.25.5-.5V6.5c-.6-.45-1.25-.75-2-1V19c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6.5C10.55 5.4 8.45 5 6.5 5"/></svg>

    </a>
    mercury-dataschema
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BBVA/mercury-dataschema/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-dataschema
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Api
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    dataschema
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    dataschema
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mercury.dataschema" class="md-nav__link">
    <span class="md-ellipsis">
      dataschema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dataschema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="anonymize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Anonymize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.anonymize_list" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.anonymize_list_any_type" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize_list_any_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.deanonymize_list" class="md-nav__link">
    <span class="md-ellipsis">
      deanonymize_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.set_key" class="md-nav__link">
    <span class="md-ellipsis">
      set_key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator" class="md-nav__link">
    <span class="md-ellipsis">
      calculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.FeatureCalculator" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureCalculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCalculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.FeatureCalculator.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.PandasStatCalculator" class="md-nav__link">
    <span class="md-ellipsis">
      PandasStatCalculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PandasStatCalculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.PandasStatCalculator.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      distribution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.StatCalculatorFactory" class="md-nav__link">
    <span class="md-ellipsis">
      StatCalculatorFactory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.create_tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      create_tutorials
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_tutorials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.create_tutorials.create_tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      create_tutorials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature" class="md-nav__link">
    <span class="md-ellipsis">
      feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.BinaryFeature" class="md-nav__link">
    <span class="md-ellipsis">
      BinaryFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.CategoricalFeature" class="md-nav__link">
    <span class="md-ellipsis">
      CategoricalFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.ContinuousFeature" class="md-nav__link">
    <span class="md-ellipsis">
      ContinuousFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.DiscreteFeature" class="md-nav__link">
    <span class="md-ellipsis">
      DiscreteFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.Feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory._build_dummy_feature" class="md-nav__link">
    <span class="md-ellipsis">
      _build_dummy_feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory.build_feature" class="md-nav__link">
    <span class="md-ellipsis">
      build_feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory.infer_datatype" class="md-nav__link">
    <span class="md-ellipsis">
      infer_datatype
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen" class="md-nav__link">
    <span class="md-ellipsis">
      schemagen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schemagen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema" class="md-nav__link">
    <span class="md-ellipsis">
      DataSchema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataSchema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.binary_feats" class="md-nav__link">
    <span class="md-ellipsis">
      binary_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.categorical_feats" class="md-nav__link">
    <span class="md-ellipsis">
      categorical_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.continuous_feats" class="md-nav__link">
    <span class="md-ellipsis">
      continuous_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.discrete_feats" class="md-nav__link">
    <span class="md-ellipsis">
      discrete_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema._get_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      _get_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.calculate_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_statistics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.deanonymize" class="md-nav__link">
    <span class="md-ellipsis">
      deanonymize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.generate" class="md-nav__link">
    <span class="md-ellipsis">
      generate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.generate_manual" class="md-nav__link">
    <span class="md-ellipsis">
      generate_manual
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mercury.dataschema" class="md-nav__link">
    <span class="md-ellipsis">
      dataschema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dataschema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="anonymize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Anonymize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.anonymize_list" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.anonymize_list_any_type" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize_list_any_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.deanonymize_list" class="md-nav__link">
    <span class="md-ellipsis">
      deanonymize_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.anonymize.Anonymize.set_key" class="md-nav__link">
    <span class="md-ellipsis">
      set_key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator" class="md-nav__link">
    <span class="md-ellipsis">
      calculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.FeatureCalculator" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureCalculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCalculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.FeatureCalculator.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.PandasStatCalculator" class="md-nav__link">
    <span class="md-ellipsis">
      PandasStatCalculator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PandasStatCalculator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.PandasStatCalculator.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      distribution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.calculator.StatCalculatorFactory" class="md-nav__link">
    <span class="md-ellipsis">
      StatCalculatorFactory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.create_tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      create_tutorials
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_tutorials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.create_tutorials.create_tutorials" class="md-nav__link">
    <span class="md-ellipsis">
      create_tutorials
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature" class="md-nav__link">
    <span class="md-ellipsis">
      feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.BinaryFeature" class="md-nav__link">
    <span class="md-ellipsis">
      BinaryFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.CategoricalFeature" class="md-nav__link">
    <span class="md-ellipsis">
      CategoricalFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.ContinuousFeature" class="md-nav__link">
    <span class="md-ellipsis">
      ContinuousFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.DiscreteFeature" class="md-nav__link">
    <span class="md-ellipsis">
      DiscreteFeature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.Feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory._build_dummy_feature" class="md-nav__link">
    <span class="md-ellipsis">
      _build_dummy_feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory.build_feature" class="md-nav__link">
    <span class="md-ellipsis">
      build_feature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.feature.FeatureFactory.infer_datatype" class="md-nav__link">
    <span class="md-ellipsis">
      infer_datatype
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen" class="md-nav__link">
    <span class="md-ellipsis">
      schemagen
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schemagen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema" class="md-nav__link">
    <span class="md-ellipsis">
      DataSchema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataSchema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.binary_feats" class="md-nav__link">
    <span class="md-ellipsis">
      binary_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.categorical_feats" class="md-nav__link">
    <span class="md-ellipsis">
      categorical_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.continuous_feats" class="md-nav__link">
    <span class="md-ellipsis">
      continuous_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.discrete_feats" class="md-nav__link">
    <span class="md-ellipsis">
      discrete_feats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema._get_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      _get_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.anonymize" class="md-nav__link">
    <span class="md-ellipsis">
      anonymize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.calculate_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_statistics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.deanonymize" class="md-nav__link">
    <span class="md-ellipsis">
      deanonymize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.from_json" class="md-nav__link">
    <span class="md-ellipsis">
      from_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.generate" class="md-nav__link">
    <span class="md-ellipsis">
      generate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.generate_manual" class="md-nav__link">
    <span class="md-ellipsis">
      generate_manual
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.to_json" class="md-nav__link">
    <span class="md-ellipsis">
      to_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mercury.dataschema.schemagen.DataSchema.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="data-schema">Data Schema</h1>


<div class="doc doc-object doc-module">



<h2 id="mercury.dataschema" class="doc doc-heading">
            <code>mercury.dataschema</code>


</h2>

    <div class="doc doc-contents first">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mercury.dataschema.anonymize" class="doc doc-heading">
            <code>anonymize</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.anonymize.Anonymize" class="doc doc-heading">
              <code class=" language-python"><span class="n">Anonymize</span><span class="p">(</span><span class="n">digest_bits</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">safe_crypto</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">


        <p>Cryptographically secure anonymization.</p>
<p>This class encrypts or hashes lists of strings using cryptographically secure standardized algorithms.
It can be used with a user defined key or without a key in which case it will produce identical hashes
across different platforms.</p>
<p>The key can be given at construction time by setting the environment variable MERCURY_ANONYMIZE_DATASCHEMA_KEY
or at any later time by calling the .set_key() method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>digest_bits</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This determines the length in (effective) bits of the output hash. As it is encoded in base64,
the number of characters will be 1/6 times this number. E.g., 96 (the default) produces 16
char long hashes. If this is set to a value other than zero, the output length is fixed, the
output is irreversible (cannot be used with .deanonymize_list()) and the algorithm used for
hashing is keyed BLAKE2 (https://www.blake2.net/).
If this is set to zero, you will get a variable length secure encryption using Galois/Counter
Mode AES. (see the argument <code>safe_crypto</code>) and the result can be deanonymized with the same key
using .deanonymize_list().</p>
              </div>
            </td>
            <td>
                  <code>96</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>safe_crypto</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This argument selects how the encryption is randomized. If True, the same original text with
the same key produces different encrypted texts each time. Note that this will change the
cardinality of the set of values to the length of the list.
If false (the default) the same text will produce the same output with the same key. This
preserves cardinality, but can be a target of attacks when the attacker has access to
encoded pairs.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/anonymize.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digest_bits</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">safe_crypto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">digest_bits</span> <span class="o">=</span> <span class="n">digest_bits</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">safe_crypto</span> <span class="o">=</span> <span class="n">safe_crypto</span>

    <span class="n">plain_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MERCURY_ANONYMIZE_DATASCHEMA_KEY&#39;</span><span class="p">)</span>
    <span class="n">plain_key</span> <span class="o">=</span> <span class="s1">&#39;&lt;void&gt;&#39;</span> <span class="k">if</span> <span class="n">plain_key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">plain_key</span>

    <span class="n">hash_key</span> <span class="o">=</span> <span class="n">hashes</span><span class="o">.</span><span class="n">Hash</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">BLAKE2s</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>

    <span class="n">hash_key</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plain_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">hash_key</span> <span class="o">=</span> <span class="n">hash_key</span><span class="o">.</span><span class="n">finalize</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.anonymize.Anonymize.anonymize_list" class="doc doc-heading">
            <code class=" language-python"><span class="n">anonymize_list</span><span class="p">(</span><span class="n">list_of_str</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Anonymize a list of strings.</p>
<p>This hashes or encrypts a list of strings. The precise function is defined at object construction.
(See the doc of the class <code>Anonymize</code> for details.)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>list_of_str</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings to be anonymized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns (list):
    The anonymized list of strings encoded in base64.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/anonymize.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anonymize_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Anonymize a list of strings.</span>

<span class="sd">    This hashes or encrypts a list of strings. The precise function is defined at object construction.</span>
<span class="sd">    (See the doc of the class `Anonymize` for details.)</span>

<span class="sd">    Args:</span>
<span class="sd">        list_of_str (list):  A list of strings to be anonymized.</span>

<span class="sd">    Returns (list):</span>
<span class="sd">        The anonymized list of strings encoded in base64.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digest_bits</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">digest_len</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digest_bits</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_str</span><span class="p">:</span>
            <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashes</span><span class="o">.</span><span class="n">Hash</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">BLAKE2b</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span>
            <span class="nb">hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hash_key</span><span class="p">)</span>
            <span class="nb">hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

            <span class="n">l2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">encodebytes</span><span class="p">(</span><span class="nb">hash</span><span class="o">.</span><span class="n">finalize</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">digest_len</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">aes</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hash_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_crypto</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_str</span><span class="p">:</span>
                <span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>		<span class="c1"># Must be &gt;8 (min requirement) and multiple of 6 (fixed length in)</span>
                <span class="n">cipher</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

                <span class="n">l2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">encodebytes</span><span class="p">(</span><span class="n">nonce</span> <span class="o">+</span> <span class="n">cipher</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nonce</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;12345678&#39;</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_str</span><span class="p">:</span>
                <span class="n">cipher</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

                <span class="n">l2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">encodebytes</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">l2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.anonymize.Anonymize.anonymize_list_any_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">anonymize_list_any_type</span><span class="p">(</span><span class="n">list_of_any</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Anonymize a list of anything that supports conversion to string.</p>
<p>This is a wrapper function over anonymize_list(). It verifies if any element in the list is
not a string first. If all elements are strings, it passes the list to anonymize_list().
Otherwise, it creates a new list of string elements and passes that to anonymize_list().</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>list_of_any</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of any data type that supports string conversion via str() to be anonymized.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns (list):
    The anonymized list of strings encoded in base64.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/anonymize.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anonymize_list_any_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Anonymize a list of anything that supports conversion to string.</span>

<span class="sd">    This is a wrapper function over anonymize_list(). It verifies if any element in the list is</span>
<span class="sd">    not a string first. If all elements are strings, it passes the list to anonymize_list().</span>
<span class="sd">    Otherwise, it creates a new list of string elements and passes that to anonymize_list().</span>

<span class="sd">    Args:</span>
<span class="sd">        list_of_any (list):  A list of any data type that supports string conversion via str() to be anonymized.</span>

<span class="sd">    Returns (list):</span>
<span class="sd">        The anonymized list of strings encoded in base64.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">list_of_any</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span>

    <span class="n">all_str</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_any</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">all_str</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">all_str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anonymize_list</span><span class="p">(</span><span class="n">list_of_any</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anonymize_list</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_of_any</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.anonymize.Anonymize.deanonymize_list" class="doc doc-heading">
            <code class=" language-python"><span class="n">deanonymize_list</span><span class="p">(</span><span class="n">list_of_str</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Deanonymize a list of strings.</p>
<p>Deanonymizes a list of anonymized strings recovering the original text. This can only be applied if
the encryption is reversible (The object was created with <code>digest_bits = 0</code>) and the key is the same
key used for encryption.</p>
<p>Raises ValueError when called on an object that does hashing (is created with <code>digest_bits &gt; 0</code>)
rather than encryption.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>list_of_str</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings anonymized using a previous .anonymize_list() call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns (list):
    The original deanonymized list of strings.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/anonymize.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">deanonymize_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deanonymize a list of strings.</span>

<span class="sd">    Deanonymizes a list of anonymized strings recovering the original text. This can only be applied if</span>
<span class="sd">    the encryption is reversible (The object was created with `digest_bits = 0`) and the key is the same</span>
<span class="sd">    key used for encryption.</span>

<span class="sd">    Raises ValueError when called on an object that does hashing (is created with `digest_bits &gt; 0`)</span>
<span class="sd">    rather than encryption.</span>


<span class="sd">    Args:</span>
<span class="sd">        list_of_str (list):  A list of strings anonymized using a previous .anonymize_list() call.</span>

<span class="sd">    Returns (list):</span>
<span class="sd">        The original deanonymized list of strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digest_bits</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;deanonymize_list() requires passing &#39;digest_bits = 0&#39; to the constructor.&quot;</span><span class="p">)</span>

    <span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="n">aes</span> <span class="o">=</span> <span class="n">AESGCM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hash_key</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_crypto</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_str</span><span class="p">:</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">decodebytes</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
            <span class="n">nonce</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
            <span class="n">cipher</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="mi">12</span><span class="p">:]</span>

            <span class="n">l2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">cipher</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nonce</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;12345678&#39;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">list_of_str</span><span class="p">:</span>
            <span class="n">cipher</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">decodebytes</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

            <span class="n">l2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span> <span class="n">cipher</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">l2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.anonymize.Anonymize.set_key" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_key</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Set the encryption key of an existing <code>Anonymize</code> object.</p>
<p>This changes the encryption key overriding the key possibly defined using the environment variable
MERCURY_ANONYMIZE_DATASCHEMA_KEY at construction. It can be called any number of times.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>encryption_key</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key as a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/anonymize.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encryption_key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the encryption key of an existing `Anonymize` object.</span>

<span class="sd">    This changes the encryption key overriding the key possibly defined using the environment variable</span>
<span class="sd">    MERCURY_ANONYMIZE_DATASCHEMA_KEY at construction. It can be called any number of times.</span>

<span class="sd">    Args:</span>
<span class="sd">        encryption_key (list):  The key as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hash_key</span> <span class="o">=</span> <span class="n">hashes</span><span class="o">.</span><span class="n">Hash</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">BLAKE2s</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>

    <span class="n">hash_key</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">encryption_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">hash_key</span> <span class="o">=</span> <span class="n">hash_key</span><span class="o">.</span><span class="n">finalize</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mercury.dataschema.calculator" class="doc doc-heading">
            <code>calculator</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.calculator.FeatureCalculator" class="doc doc-heading">
            <code>FeatureCalculator</code>


</h4>


    <div class="doc doc-contents ">


        <p>This is a base class with the operation definitions. Several classes must
extend this, implementing its operations for each one of the supported frameworks
(namely Pandas and Pyspark)</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.calculator.FeatureCalculator.set_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Set attributes with the keys of the dictionary. These can be later used within
specific calculator methods (like <code>distribution()</code> for specifying the number of bins).</p>
<p>For this to work, the parameter must have been explicitly declared during object's
constructor. That is, you cannot pass here a parameter name which the calculator doesn't
support (or this will raise a ValueError).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names and values of the desired parameters to set.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises ValueError if any keyword argument does not exist among the existing attributes of
the object.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/calculator.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Set attributes with the keys of the dictionary. These can be later used within</span>
<span class="sd">    specific calculator methods (like `distribution()` for specifying the number of bins).</span>

<span class="sd">    For this to work, the parameter must have been explicitly declared during object&#39;s</span>
<span class="sd">    constructor. That is, you cannot pass here a parameter name which the calculator doesn&#39;t</span>
<span class="sd">    support (or this will raise a ValueError).</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): The names and values of the desired parameters to set.</span>

<span class="sd">    Raises ValueError if any keyword argument does not exist among the existing attributes of</span>
<span class="sd">    the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error. This calculator doesn&#39;t support the `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` parameter. Available options are </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_registered_params</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.calculator.PandasStatCalculator" class="doc doc-heading">
              <code class=" language-python"><span class="n">PandasStatCalculator</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mercury.dataschema.calculator.FeatureCalculator" href="#mercury.dataschema.calculator.FeatureCalculator">FeatureCalculator</a></code></p>


        <p>Implementation of a Calculator for Pandas</p>
<p>Supported setting keys are the following:</p>
<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`distribution_bins_method`</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">set</span><span class="n">ting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="k">when</span>
<span class="w">  </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n n-Quoted">`distribution`</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="n">either</span><span class="w"> </span><span class="n">discrete</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">continuous</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`limit_categorical_perc`</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">truncating</span><span class="w"> </span><span class="n">categorical</span><span class="w"> </span><span class="k">variables</span><span class="w"> </span><span class="k">with</span>
<span class="w">   </span><span class="n">high</span><span class="w"> </span><span class="n">cardinality</span>
</code></pre></div>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/calculator.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distribution_bins_method</span> <span class="o">=</span> <span class="s1">&#39;sqrt&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit_categorical_perc</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.calculator.PandasStatCalculator.distribution" class="doc doc-heading">
            <code class=" language-python"><span class="n">distribution</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculates the histogram for a given feature.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="pd.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas column with the data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature</code>
            </td>
            <td>
                  <code>Feature</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature which holds the metadata</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bins</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Only used for numerical features) If a number, the histogram will
  have <code>bins</code> bins. If a string, it will use an automatic NumPy method for
  estimating this number. See more about available methods here:
  https://numpy.org/devdocs/reference/generated/numpy.histogram_bin_edges.html#numpy.histogram_bin_edges.
  If None is provided, it uses the default class' method, which is <code>sqrt</code>.
  For binary features it simply uses bins=2 and for categoricals, bins=|categories| if is not limited
  with 'limit_categorical_perc' in set_config method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/calculator.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculates the histogram for a given feature.</span>

<span class="sd">    Args:</span>
<span class="sd">        column (pd.Series): Pandas column with the data</span>
<span class="sd">        feature (Feature): Feature which holds the metadata</span>
<span class="sd">        bins (Union[int, str, None]): (Only used for numerical features) If a number, the histogram will</span>
<span class="sd">              have `bins` bins. If a string, it will use an automatic NumPy method for</span>
<span class="sd">              estimating this number. See more about available methods here:</span>
<span class="sd">              https://numpy.org/devdocs/reference/generated/numpy.histogram_bin_edges.html#numpy.histogram_bin_edges.</span>
<span class="sd">              If None is provided, it uses the default class&#39; method, which is `sqrt`.</span>
<span class="sd">              For binary features it simply uses bins=2 and for categoricals, bins=|categories| if is not limited</span>
<span class="sd">              with &#39;limit_categorical_perc&#39; in set_config method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;no_nan_filtered&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
        <span class="n">no_na</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;no_nan_filtered&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">no_na</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">no_na</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;no_nan_filtered&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="p">(</span><span class="n">BinaryFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span><span class="p">)):</span>

        <span class="n">no_na</span> <span class="o">=</span> <span class="n">no_na</span><span class="p">[</span><span class="n">no_na</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">])]</span>  <span class="c1"># It may be truncated</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_na</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_na</span><span class="p">))</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">values</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]]</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution_bins_method</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">bins</span> <span class="k">else</span> <span class="n">bins</span>
        <span class="n">histo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">no_na</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">histo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">no_na</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]]</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">histo</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.calculator.StatCalculatorFactory" class="doc doc-heading">
            <code>StatCalculatorFactory</code>


</h4>


    <div class="doc doc-contents ">


        <p>This static class receives a DataFrame and returns a particular implementation
of a FeatureCalculator</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mercury.dataschema.create_tutorials" class="doc doc-heading">
            <code>create_tutorials</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mercury.dataschema.create_tutorials.create_tutorials" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_tutorials</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Copies mercury.dataschema tutorial notebooks to <code>destination</code>. A folder will be created inside
destination, named 'dataschema_tutorials'. The folder <code>destination</code> must exist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>destination</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The destination directory</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>silent</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, suppresses output on success.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>destination</code> is equal to source path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># copy tutorials to /tmp/dataschema_tutorials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mercury.dataschema</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_tutorials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_tutorials</span><span class="p">(</span><span class="s1">&#39;/tmp&#39;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/create_tutorials.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_tutorials</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">silent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copies mercury.dataschema tutorial notebooks to `destination`. A folder will be created inside</span>
<span class="sd">    destination, named &#39;dataschema_tutorials&#39;. The folder `destination` must exist.</span>

<span class="sd">    Args:</span>
<span class="sd">        destination (str): The destination directory</span>
<span class="sd">        silent (bool): If True, suppresses output on success.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `destination` is equal to source path.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # copy tutorials to /tmp/dataschema_tutorials</span>
<span class="sd">        &gt;&gt;&gt; from mercury.dataschema import create_tutorials</span>
<span class="sd">        &gt;&gt;&gt; create_tutorials(&#39;/tmp&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="n">__package__</span><span class="p">,</span> <span class="s1">&#39;tutorials&#39;</span><span class="p">)</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">src</span> <span class="o">!=</span> <span class="n">dst</span><span class="p">,</span> <span class="s1">&#39;Destination (</span><span class="si">%s</span><span class="s1">) cannot be the same as source.&#39;</span> <span class="o">%</span> <span class="n">src</span>

    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dst</span><span class="p">),</span> <span class="s1">&#39;Destination (</span><span class="si">%s</span><span class="s1">) must be a directory.&#39;</span> <span class="o">%</span> <span class="n">dst</span>

    <span class="n">dst</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="s1">&#39;dataschema_tutorials&#39;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">),</span> <span class="s1">&#39;Destination (</span><span class="si">%s</span><span class="s1">) already exists&#39;</span> <span class="o">%</span> <span class="n">dst</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tutorials copied to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dst</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mercury.dataschema.feature" class="doc doc-heading">
            <code>feature</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.BinaryFeature" class="doc doc-heading">
              <code class=" language-python"><span class="n">BinaryFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code></p>


        <p>This class represents a binary feature within a schema
(i.e. only two possible values).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the feature</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.CategoricalFeature" class="doc doc-heading">
              <code class=" language-python"><span class="n">CategoricalFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code></p>


        <p>This class represents a categorical feature within a schema
(i.e. only N possible values).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the feature</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.ContinuousFeature" class="doc doc-heading">
              <code class=" language-python"><span class="n">ContinuousFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code></p>


        <p>This class represents a continuous feature within a schema
(e.g. a float).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the feature</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.DiscreteFeature" class="doc doc-heading">
              <code class=" language-python"><span class="n">DiscreteFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code></p>


        <p>This class represents a discrete feature within a schema
(i.e. any number without decimals).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the feature</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.Feature" class="doc doc-heading">
              <code class=" language-python"><span class="n">Feature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">


        <p>This class represents a generic feature within a schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="mercury.dataschema.feature.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the feature</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">dtype</span><span class="p">:</span> <span class="n">DataType</span> <span class="o">=</span> <span class="kc">None</span>
             <span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="k">else</span> <span class="n">DataType</span><span class="o">.</span><span class="n">UNKNOWN</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Intermediate heavy calculations</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.feature.FeatureFactory" class="doc doc-heading">
              <code class=" language-python"><span class="n">FeatureFactory</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">







                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.feature.FeatureFactory._build_dummy_feature" class="doc doc-heading">
            <code class=" language-python"><span class="n">_build_dummy_feature</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns a dummy and uninitialized feature. This method is not intended to be
used apart from serialization purposes.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_build_dummy_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datatype</span><span class="p">:</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">:</span> <span class="n">FeatType</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Feature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Returns a dummy and uninitialized feature. This method is not intended to be</span>
<span class="sd">    used apart from serialization purposes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">feat_type</span> <span class="o">==</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">BINARY</span><span class="p">:</span>
        <span class="n">feat</span> <span class="o">=</span> <span class="n">BinaryFeature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">feat_type</span> <span class="o">==</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">:</span>
        <span class="n">feat</span> <span class="o">=</span> <span class="n">CategoricalFeature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">feat_type</span> <span class="o">==</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">DISCRETE</span><span class="p">:</span>
        <span class="n">feat</span> <span class="o">=</span> <span class="n">DiscreteFeature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">feat_type</span> <span class="o">==</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">CONTINUOUS</span><span class="p">:</span>
        <span class="n">feat</span> <span class="o">=</span> <span class="n">ContinuousFeature</span><span class="p">()</span>
    <span class="n">feat</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">datatype</span>
    <span class="n">feat</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">return</span> <span class="n">feat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.feature.FeatureFactory.build_feature" class="doc doc-heading">
            <code class=" language-python"><span class="n">build_feature</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold_categorical</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">force_feat_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds a schema Feature object given a column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column to be analyzed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>colname</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column (feature)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threshold_categorical</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>percentage of necessary unique values for a feature to be considered
           categorical. If the percentage of unique values &lt; cat_threshold, the
           column will be taken as categorical. This parameter can be a single float
           (same threshold for all columns) or a dict in which each key is the name of
           the column. Use the later for custom thresholds per column.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_feat_type</code>
            </td>
            <td>
                  <code><span title="mercury.dataschema.feature.FeatType">FeatType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If user wants to force a variable to be of certain type, he/she can use
            this parameter and its type will not be auto-inferred, but set to this.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If this is set to False, possible inner warnings won't be shown.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature with only the base statistics calculated</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">column</span><span class="p">:</span> <span class="s1">&#39;pandas.Series&#39;</span><span class="p">,</span>  <span class="c1"># noqa: F821</span>
                  <span class="n">colname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">threshold_categorical</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
                  <span class="n">force_feat_type</span><span class="p">:</span> <span class="n">FeatType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Feature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds a schema Feature object given a column.</span>

<span class="sd">    Args:</span>
<span class="sd">        column: Column to be analyzed</span>
<span class="sd">        colname: Name of the column (feature)</span>
<span class="sd">        threshold_categorical: percentage of necessary unique values for a feature to be considered</span>
<span class="sd">                       categorical. If the percentage of unique values &lt; cat_threshold, the</span>
<span class="sd">                       column will be taken as categorical. This parameter can be a single float</span>
<span class="sd">                       (same threshold for all columns) or a dict in which each key is the name of</span>
<span class="sd">                       the column. Use the later for custom thresholds per column.</span>
<span class="sd">        force_feat_type: If user wants to force a variable to be of certain type, he/she can use</span>
<span class="sd">                        this parameter and its type will not be auto-inferred, but set to this.</span>
<span class="sd">        verbose: If this is set to False, possible inner warnings won&#39;t be shown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Feature with only the base statistics calculated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">feat</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">()</span><span class="o">.</span><span class="n">build_stats</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">datatype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infer_datatype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">feat</span><span class="p">)</span>
    <span class="n">feat_type</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">UNKNOWN</span>

    <span class="c1"># If user forces the feature type we kindly fulfill his/her wishes</span>
    <span class="k">if</span> <span class="n">force_feat_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_dummy_feature</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">force_feat_type</span><span class="p">,</span> <span class="n">colname</span><span class="p">)</span>
        <span class="n">feat</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">stats</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">feat</span>

    <span class="k">if</span> <span class="n">feat</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;cardinality&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">feat_type</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">BINARY</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Data could still be either categorical, discrete or continuous</span>
        <span class="k">if</span> <span class="n">datatype</span> <span class="ow">is</span> <span class="n">DataType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">:</span>
            <span class="n">feat_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_feature_type_from_float</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">threshold_categorical</span><span class="p">,</span> <span class="n">colname</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">datatype</span> <span class="ow">is</span> <span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">:</span>
            <span class="n">feat_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_feature_type_from_int</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">threshold_categorical</span><span class="p">,</span> <span class="n">colname</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">is</span> <span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">datatype</span> <span class="ow">is</span> <span class="n">DataType</span><span class="o">.</span><span class="n">CATEGORICAL</span><span class="p">):</span>
            <span class="n">feat_type</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">CATEGORICAL</span>

    <span class="n">featret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_dummy_feature</span><span class="p">(</span><span class="n">datatype</span><span class="p">,</span> <span class="n">feat_type</span><span class="p">,</span> <span class="n">colname</span><span class="p">)</span>
    <span class="n">featret</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">stats</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">featret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.feature.FeatureFactory.infer_datatype" class="doc doc-heading">
            <code class=" language-python"><span class="n">infer_datatype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Finds out the data type of the column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column which datatype will be inferred</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.dataschema.feature.Feature" href="#mercury.dataschema.feature.Feature">Feature</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature object. This is needed because we want to cache several internal
     operations, so future calls are faster.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="mercury.dataschema.feature.DataType">DataType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the datatype of the column</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/feature.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">infer_datatype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="n">feature</span><span class="p">:</span> <span class="n">Feature</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataType</span><span class="p">:</span>  <span class="c1"># noqa: F821</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Finds out the data type of the column.</span>

<span class="sd">    Args:</span>
<span class="sd">        column: column which datatype will be inferred</span>
<span class="sd">        feature: Feature object. This is needed because we want to cache several internal</span>
<span class="sd">                 operations, so future calls are faster.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Returns the datatype of the column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">UNKNOWN</span>

    <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">CATEGORICAL</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">):</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">BOOL</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">):</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">FLOAT</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;no_nan_filtered&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">datatype</span> <span class="o">=</span> <span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span>
        <span class="c1"># TODO: Este tipo puede ser otro array</span>
        <span class="c1"># TODO: Este tipo puede ser un json (dict)</span>
        <span class="c1"># TODO: Este tipo puede ser un datetime</span>

    <span class="k">return</span> <span class="n">datatype</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mercury.dataschema.schemagen" class="doc doc-heading">
            <code>schemagen</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="mercury.dataschema.schemagen.DataSchema" class="doc doc-heading">
              <code class=" language-python"><span class="n">DataSchema</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">


        <p>Dataset schema</p>
<p>This class takes a dataframe and generates its schema as a collection of feature.
Feature objects. Each one of them will contain metadata and statistics about a
column of the original dataframe that can be further exploded.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">schma</span> <span class="o">=</span> <span class="n">DataSchema</span><span class="p">()</span>        <span class="o">&gt;&gt;&gt;</span>            <span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>        <span class="o">&gt;&gt;&gt;</span>            <span class="o">.</span><span class="n">calculate_statistics</span><span class="p">()</span>
 <span class="s1">&#39;DISBURSED_AMOUNT&#39;</span><span class="p">:</span> <span class="n">Categorical</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">DISBURSED_AMOUNT</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;ASSET_COST&#39;</span><span class="p">:</span> <span class="n">Categorical</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">ASSET_COST</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;LTV&#39;</span><span class="p">:</span> <span class="n">Continuous</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">LTV</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">),</span>
 <span class="s1">&#39;BUREAU_SCORE&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">BUREAU_SCORE</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;BUREAU_SCORE_DESCRIPTION&#39;</span><span class="p">:</span> <span class="n">Categorical</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">BUREAU_SCORE_DESCRIPTION</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
 <span class="s1">&#39;NEW_LOANS_IN_LAST_SIX_MONTHS&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">NEW_LOANS_IN_LAST_SIX_MONTHS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;DEFAULTED_LOANS_IN_LAST_SIX_MONTHS&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">DEFAULTED_LOANS_IN_LAST_SIX_MONTHS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;NUM_LOANS_TAKEN&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">NUM_LOANS_TAKEN</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;NUM_ACTIVE_LOANS&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">NUM_ACTIVE_LOANS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;NUM_DEFAULTED_LOANS&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">NUM_DEFAULTED_LOANS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;AGE&#39;</span><span class="p">:</span> <span class="n">Discrete</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">AGE</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;GENDER&#39;</span><span class="p">:</span> <span class="n">Binary</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">GENDER</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
 <span class="s1">&#39;CIVIL_STATUS&#39;</span><span class="p">:</span> <span class="n">Categorical</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">CIVIL_STATUS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
 <span class="s1">&#39;ORIGIN&#39;</span><span class="p">:</span> <span class="n">Binary</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">ORIGIN</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">STRING</span><span class="p">),</span>
 <span class="s1">&#39;DIGITAL&#39;</span><span class="p">:</span> <span class="n">Binary</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">),</span>
 <span class="s1">&#39;SCORE&#39;</span><span class="p">:</span> <span class="n">Continuous</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">SCORE</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">),</span>
 <span class="s1">&#39;PREDICTION&#39;</span><span class="p">:</span> <span class="n">Binary</span> <span class="n">Feature</span> <span class="p">(</span><span class="n">NAME</span><span class="o">=</span><span class="n">PREDICTION</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">)}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schma</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="s1">&#39;SCORE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span>
<span class="p">{</span><span class="s1">&#39;num_nan&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="s1">&#39;percent_nan&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="mi">233154</span><span class="p">,</span>
<span class="s1">&#39;percent_unique&#39;</span><span class="p">:</span> <span class="mf">0.7967352050576014</span><span class="p">,</span>
<span class="s1">&#39;cardinality&#39;</span><span class="p">:</span> <span class="mi">185762</span><span class="p">,</span>
<span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.17454321487679067</span><span class="p">,</span>
<span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.9373813084029072</span><span class="p">,</span>
<span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">0.7625553210045813</span><span class="p">,</span>
<span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.15401509786623635</span><span class="p">,</span>
<span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mf">7.48617716e-07</span><span class="p">,</span> <span class="mf">1.07579979e-06</span><span class="p">,</span> <span class="mf">1.40298186e-06</span><span class="p">,</span> <span class="mf">1.73016394e-06</span><span class="p">,</span>
        <span class="mf">2.05734601e-06</span><span class="p">,</span> <span class="mf">2.38452809e-06</span><span class="p">,</span> <span class="mf">2.71171016e-06</span><span class="p">,</span> <span class="mf">3.03889224e-06</span><span class="p">,</span>
        <span class="mf">3.36607431e-06</span><span class="p">,</span> <span class="mf">3.69325638e-06</span><span class="p">,</span> <span class="mf">4.02043846e-06</span><span class="p">])}</span>
<span class="c1"># Specifying custom parameters (shared among all features) for the calculate_statistics method</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schma</span> <span class="o">=</span> <span class="n">DataSchema</span><span class="p">()</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">calculate_statistics</span><span class="p">({</span><span class="s1">&#39;distribution_bins_method&#39;</span><span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">})</span>  <span class="c1"># Specify bin generation method (see numpy.hist)</span>

<span class="c1"># We can also specify granular statistic parameters per variable</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schma</span> <span class="o">=</span> <span class="n">DataSchema</span><span class="p">()</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">calculate_statistics</span><span class="p">({</span><span class="s1">&#39;SCORE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;distribution_bins_method&#39;</span><span class="p">:</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">}})</span>  <span class="c1"># Specify bin generation method (see numpy.hist)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">schma</span> <span class="o">=</span> <span class="n">DataSchema</span><span class="p">()</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>        <span class="o">...</span>    <span class="o">.</span><span class="n">calculate_statistics</span><span class="p">({</span><span class="s1">&#39;SCORE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;distribution_bins_method&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>  <span class="c1"># Specify 5 bins only for numerical features</span>
</code></pre></div>
</details>





                  <details class="quote">
                    <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
                    <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">feats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_feat_factory</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_generated</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="mercury.dataschema.schemagen.DataSchema.binary_feats" class="doc doc-heading">
            <code class=" language-python"><span class="n">binary_feats</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>List with the names of all binary features</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="mercury.dataschema.schemagen.DataSchema.categorical_feats" class="doc doc-heading">
            <code class=" language-python"><span class="n">categorical_feats</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>List with the names of all categorical features</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="mercury.dataschema.schemagen.DataSchema.continuous_feats" class="doc doc-heading">
            <code class=" language-python"><span class="n">continuous_feats</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>List with the names of all continuous features</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="mercury.dataschema.schemagen.DataSchema.discrete_feats" class="doc doc-heading">
            <code class=" language-python"><span class="n">discrete_feats</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>List with the names of all discrete features</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema._get_threshold" class="doc doc-heading">
            <code class=" language-python"><span class="n">_get_threshold</span><span class="p">(</span><span class="n">dataset_size</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculates a dynamic threshold for determining whether a variable is categorical
given the dataset. It uses an asymptotic function (whose lim-&gt;0) clipped to a maximum value of 1.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculates a dynamic threshold for determining whether a variable is categorical</span>
<span class="sd">    given the dataset. It uses an asymptotic function (whose lim-&gt;0) clipped to a maximum value of 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span> <span class="o">/</span> <span class="p">(</span><span class="n">dataset_size</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.anonymize" class="doc doc-heading">
            <code class=" language-python"><span class="n">anonymize</span><span class="p">(</span><span class="n">anonymize_params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Anonymize the selected features of a data schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>anonymize_params</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary where the keys are the names of the columns to be anonymized and the values
              are mercury.contrib.dataschema.Anonymize objects that can be used to anonymize them.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises:
    UserWarning, if anonymize_params is empty.
    ValueError, if the feature selected to deanonymize is not binary or categorical, or is not a feature of the dataschema.</p>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">anonymize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anonymize_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Anonymize the selected features of a data schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        anonymize_params: Dictionary where the keys are the names of the columns to be anonymized and the values</span>
<span class="sd">                          are mercury.contrib.dataschema.Anonymize objects that can be used to anonymize them.</span>
<span class="sd">    Raises:</span>
<span class="sd">        UserWarning, if anonymize_params is empty.</span>
<span class="sd">        ValueError, if the feature selected to deanonymize is not binary or categorical, or is not a feature of the dataschema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">anonymize_params</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;To anonymize, it is necessary to use a dictionary with the format: {&#39;var1&#39;:anonymizer1, &#39;var2&#39;:anonymizer2}&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">feat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">anonymize_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input Error: Keys of &#39;anonymize_params&#39; dictionary must be columns name of the data schema&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">anon</span> <span class="o">=</span> <span class="n">anonymize_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">anon</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="p">(</span><span class="n">BinaryFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input Error: Anonymze only supports Categorical or Binary variables -&gt; </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">, You can use </span><span class="se">\</span>
<span class="s2">                                    the `force_types` param in &#39;generate()&#39; to specify which features should be categorical &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">anon</span><span class="o">.</span>\
                    <span class="n">anonymize_list_any_type</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">anon</span><span class="o">.</span>\
                    <span class="n">anonymize_list_any_type</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.calculate_statistics" class="doc doc-heading">
            <code class=" language-python"><span class="n">calculate_statistics</span><span class="p">(</span><span class="n">calculator_configs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Triggers the computation of all statistics for all registered features
of the schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>calculator_configs</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional configurations for each of the calculator parameters.
                This can be either a dict or a "dict of dicts". In the first case,
                the statistics for ALL FEATURES will be computed with those parameters.
                Additionally, you can specify a mapping of [feature_name: {config}] with
                granular configurations per feature.
                The supported configuration keys are the attributes declared within a calculator class.
                See mercury.contrib.dataschema.calculator.PandasStatCalculator (or Spark) for details.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_statistics</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">calculator_configs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Triggers the computation of all statistics for all registered features</span>
<span class="sd">    of the schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        calculator_configs: Optional configurations for each of the calculator parameters.</span>
<span class="sd">                            This can be either a dict or a &quot;dict of dicts&quot;. In the first case,</span>
<span class="sd">                            the statistics for ALL FEATURES will be computed with those parameters.</span>
<span class="sd">                            Additionally, you can specify a mapping of [feature_name: {config}] with</span>
<span class="sd">                            granular configurations per feature.</span>
<span class="sd">                            The supported configuration keys are the attributes declared within a calculator class.</span>
<span class="sd">                            See mercury.contrib.dataschema.calculator.PandasStatCalculator (or Spark) for details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">featnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">calculator_configs</span> <span class="o">=</span> <span class="n">calculator_configs</span> <span class="k">if</span> <span class="n">calculator_configs</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="c1"># User can pass us two  types:</span>
    <span class="c1">#  - {&#39;param&#39;: &#39;value&#39;, &#39;param2&#39;: &#39;value&#39;} -&gt; Single config shared for all variables</span>
    <span class="c1">#  - {{config_var1}, {config_var2}, {config_var3}, ...} -&gt; 1 config per variable</span>
    <span class="n">multiple_configs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">calculator_configs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">calculator_configs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span>

    <span class="c1"># Case when user pass a single shared config</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">multiple_configs</span><span class="p">:</span>
        <span class="n">calculator</span> <span class="o">=</span> <span class="n">StatCalculatorFactory</span><span class="o">.</span><span class="n">build_calculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">)</span>
        <span class="n">calculator</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="n">calculator_configs</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">featnames</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">multiple_configs</span><span class="p">:</span>
            <span class="c1"># Case when user pass one config per variable</span>
            <span class="n">calculator</span> <span class="o">=</span> <span class="n">StatCalculatorFactory</span><span class="o">.</span><span class="n">build_calculator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">calculator_configs</span><span class="p">:</span>
                <span class="n">calculator</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="p">(</span><span class="n">calculator_configs</span><span class="p">[</span><span class="n">feature</span><span class="p">]))</span>

        <span class="c1"># Calculate distributions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">build_stats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">feature</span><span class="p">],</span> <span class="n">calculator</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.deanonymize" class="doc doc-heading">
            <code class=" language-python"><span class="n">deanonymize</span><span class="p">(</span><span class="n">anonymize_params</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>De-anonymize the selected features on a preloaded schema.</p>
<p>Raises UserWarning, if anonymize_params is empty.
Raises ValueError, if the feature selected to deanonymize is not binary or categorical, or is not a feature of the dataschema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>anonymize_params</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary where the keys are the names of the columns to be deanonymized and the values
              are mercury.contrib.dataschema.Anonymize objects that can be used to deanonymize them.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">deanonymize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anonymize_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    De-anonymize the selected features on a preloaded schema.</span>

<span class="sd">    Raises UserWarning, if anonymize_params is empty.</span>
<span class="sd">    Raises ValueError, if the feature selected to deanonymize is not binary or categorical, or is not a feature of the dataschema.</span>

<span class="sd">    Args:</span>
<span class="sd">        anonymize_params: Dictionary where the keys are the names of the columns to be deanonymized and the values</span>
<span class="sd">                          are mercury.contrib.dataschema.Anonymize objects that can be used to deanonymize them.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">anonymize_params</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;To De-anonymize, it is necessary to use a dictionary with the format: {&#39;var1&#39;:anonym1, &#39;var2&#39;:anonym2}&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">feat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">anonymize_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input Error: Keys of &#39;anonymize_params&#39; dictionary must be columns name of the data schema&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">anon</span> <span class="o">=</span> <span class="n">anonymize_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">anon</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="p">(</span><span class="n">BinaryFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input Error: Deanonymize only supports Categorical or Binary variables -&gt; </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">operation</span> <span class="o">=</span> <span class="nb">int</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">DataType</span><span class="o">.</span><span class="n">INTEGER</span> <span class="k">else</span> <span class="nb">str</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">anon</span><span class="o">.</span><span class="n">deanonymize_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;distribution_bins&#39;</span><span class="p">])))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">anon</span><span class="o">.</span><span class="n">deanonymize_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">])))</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.from_json" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_json</span><span class="p">(</span><span class="n">json_obj</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Rebuilds an schema from a JSON representation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.dataschema.schemagen.DataSchema" href="#mercury.dataschema.schemagen.DataSchema">DataSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rebuild schema</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_obj</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Rebuilds an schema from a JSON representation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rebuild schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">DataSchema</span><span class="p">()</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">FeatureFactory</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">featname</span><span class="p">,</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">json_obj</span><span class="p">[</span><span class="s1">&#39;feats&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="n">FeatType</span><span class="p">[</span><span class="n">feat</span><span class="p">[</span><span class="s1">&#39;feat_type&#39;</span><span class="p">]]</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">DataType</span><span class="p">[</span><span class="n">feat</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]]</span>
        <span class="n">feat_name</span> <span class="o">=</span> <span class="n">feat</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">dummy_feat</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">_build_dummy_feature</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">feat_name</span><span class="p">)</span>
        <span class="n">dummy_feat</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="n">feat</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span>
        <span class="n">schema</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">featname</span><span class="p">]</span> <span class="o">=</span> <span class="n">dummy_feat</span>

    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.generate" class="doc doc-heading">
            <code class=" language-python"><span class="n">generate</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">force_types</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds the schema. For float and integer datatypes, by default the method tries to infer
    if a feature is categorical or numeric (Continuous or Discrete) depending on the percentage
    of unique values. However, that doesn't work in all the cases. In those cases, you can use
    the <code>force_types</code> param to specify which features should be categorical and which
    should be numeric independently of the percentage of unique values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame on which the schema will be inferred.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_types</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="mercury.dataschema.feature.FeatType">FeatType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the form <FEATURE_NAME, FeatType> that contains the features to be
        forced to a specific type (Continuous, Discrete, Categorical...)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_stats</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom statistics to be calculated for each column</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to show or filter all possible warning messages</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;pyspark.sql.DataFrame&quot;</span><span class="p">],</span>  <span class="c1"># noqa: F821</span>
    <span class="n">force_types</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FeatType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">custom_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds the schema. For float and integer datatypes, by default the method tries to infer</span>
<span class="sd">        if a feature is categorical or numeric (Continuous or Discrete) depending on the percentage</span>
<span class="sd">        of unique values. However, that doesn&#39;t work in all the cases. In those cases, you can use</span>
<span class="sd">        the `force_types` param to specify which features should be categorical and which</span>
<span class="sd">        should be numeric independently of the percentage of unique values.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataframe: DataFrame on which the schema will be inferred.</span>
<span class="sd">        force_types: Dictionary with the form &lt;FEATURE_NAME, FeatType&gt; that contains the features to be</span>
<span class="sd">                    forced to a specific type (Continuous, Discrete, Categorical...)</span>
<span class="sd">        custom_stats: Custom statistics to be calculated for each column</span>
<span class="sd">        verbose: whether to show or filter all possible warning messages</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;pyspark&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Sorry, Pyspark is not supported yet...&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_generated</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_feat_factory</span> <span class="o">=</span> <span class="n">FeatureFactory</span><span class="p">()</span>

    <span class="n">inferring_types</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">force_types</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_threshold</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">))</span>

        <span class="c1"># Look if the feature type has been specified</span>
        <span class="n">forced_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inferring_types</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">force_types</span><span class="p">:</span>
            <span class="n">forced_type</span> <span class="o">=</span> <span class="n">force_types</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="n">feat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feat_factory</span><span class="o">.</span><span class="n">build_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">],</span>
            <span class="n">col</span><span class="p">,</span>
            <span class="n">force_feat_type</span><span class="o">=</span><span class="n">forced_type</span><span class="p">,</span>
            <span class="n">threshold_categorical</span><span class="o">=</span><span class="n">thresh</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">inferring_types</span> <span class="ow">and</span> <span class="n">verbose</span>  <span class="c1"># Only show warnings (if any) when using default args.</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">feat</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.generate_manual" class="doc doc-heading">
            <code class=" language-python"><span class="n">generate_manual</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">categ_columns</span><span class="p">,</span> <span class="n">discrete_columns</span><span class="p">,</span> <span class="n">binary_columns</span><span class="p">,</span> <span class="n">custom_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Builds the schema manually. This acts like <code>generate()</code> but in a more restrictive way.
All the names passed to <code>categ_columns</code> will be taken as categorical features, no more, no less.
It will avoid making automatic type inference on every feature not in <code>categ_columns</code>.
The same rule is applied on <code>discrete_columns</code>.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is considered to be low level. If you use this, make sure the type assignment
to each feature type is compatible with the datatypes (float, int, string,...) in the column or
a later call to <code>calculate_statistics</code> could fail.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataframe</code>
            </td>
            <td>
                  <code><span title="pd.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame on which the schema will be inferred.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>categ_columns</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of columns which will be forced to be taken as categorical. Warning:
          all features not in this list are guaranteed not being categorical</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>discrete_columns</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of columns which will be forced to be taken as discrete. Warning:
          all features not in this list are guaranteed not to be taken as discrete (i.e.
          they will be continuous).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binary_columns</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of column which will be forced to be taken as binary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_stats</code>
            </td>
            <td>
                  <code>Optional[<span title="typing.Dict">Dict</span>[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom statistics to be calculated for each column.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_manual</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataframe</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">,</span> <span class="s2">&quot;pyspark.sql.DataFrame&quot;</span><span class="p">],</span>  <span class="c1"># noqa: F821</span>
    <span class="n">categ_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">discrete_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">binary_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">custom_stats</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Builds the schema manually. This acts like `generate()` but in a more restrictive way.</span>
<span class="sd">    All the names passed to `categ_columns` will be taken as categorical features, no more, no less.</span>
<span class="sd">    It will avoid making automatic type inference on every feature not in `categ_columns`.</span>
<span class="sd">    The same rule is applied on `discrete_columns`.</span>

<span class="sd">    Note:</span>
<span class="sd">        This method is considered to be low level. If you use this, make sure the type assignment</span>
<span class="sd">        to each feature type is compatible with the datatypes (float, int, string,...) in the column or</span>
<span class="sd">        a later call to `calculate_statistics` could fail.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataframe (pd.DataFrame): DataFrame on which the schema will be inferred.</span>
<span class="sd">        categ_columns (List[str]): list of columns which will be forced to be taken as categorical. Warning:</span>
<span class="sd">                      all features not in this list are guaranteed not being categorical</span>
<span class="sd">        discrete_columns (List[str]): list of columns which will be forced to be taken as discrete. Warning:</span>
<span class="sd">                      all features not in this list are guaranteed not to be taken as discrete (i.e.</span>
<span class="sd">                      they will be continuous).</span>
<span class="sd">        binary_columns (List[str]): list of column which will be forced to be taken as binary.</span>
<span class="sd">        custom_stats (Optional[Dict[str, Any]]): Custom statistics to be calculated for each column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">force_types</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">categ_columns</span><span class="p">:</span>
            <span class="n">force_types</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">CATEGORICAL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Is in either binary, continuous or discrete lists</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">discrete_columns</span><span class="p">:</span>
                <span class="n">force_types</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">DISCRETE</span>
            <span class="k">elif</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">binary_columns</span><span class="p">:</span>
                <span class="n">force_types</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">BINARY</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">force_types</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">FeatType</span><span class="o">.</span><span class="n">CONTINUOUS</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">dataframe</span><span class="o">=</span><span class="n">dataframe</span><span class="p">,</span>
        <span class="n">force_types</span><span class="o">=</span><span class="n">force_types</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">custom_stats</span><span class="o">=</span><span class="n">custom_stats</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.load" class="doc doc-heading">
            <code class=" language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Loads a previously serialized schema (as JSON)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>path to the serialized schema</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.dataschema.schemagen.DataSchema" href="#mercury.dataschema.schemagen.DataSchema">DataSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rebuilt schema</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Loads a previously serialized schema (as JSON)</span>

<span class="sd">    Args:</span>
<span class="sd">        path: path to the serialized schema</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rebuilt schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">json_obj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.save" class="doc doc-heading">
            <code class=" language-python"><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Saves a JSON with the schema representation</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>where the JSON will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Saves a JSON with the schema representation</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): where the JSON will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.to_json" class="doc doc-heading">
            <code class=" language-python"><span class="n">to_json</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Converts the schema to a JSON representation</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with the features and their stats</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Converts the schema to a JSON representation</span>

<span class="sd">    Returns:</span>
<span class="sd">        dictionary with the features and their stats</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">retdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">feats</span><span class="o">=</span><span class="nb">dict</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">retdict</span><span class="p">[</span><span class="s1">&#39;feats&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">retdict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mercury.dataschema.schemagen.DataSchema.validate" class="doc doc-heading">
            <code class=" language-python"><span class="n">validate</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Validates other schema with this one. The other schema will be considered
valid if it shares the same feature names and datatypes with this.</p>
<p>Raises RuntimeError if other schema differs from this one</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="mercury.dataschema.schemagen.DataSchema" href="#mercury.dataschema.schemagen.DataSchema">DataSchema</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>other schema to be checked from this one</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>mercury/dataschema/schemagen.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;DataSchema&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Validates other schema with this one. The other schema will be considered</span>
<span class="sd">    valid if it shares the same feature names and datatypes with this.</span>

<span class="sd">    Raises RuntimeError if other schema differs from this one</span>

<span class="sd">    Args:</span>
<span class="sd">        other: other schema to be checked from this one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check feature names match</span>
    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features do not match. These ones are not present on both datasets </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check feature and data types are the same</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">feats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Feature types do not match. &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; in other is &quot;&quot;&quot;</span>
                               <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2">. However, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="si">}</span><span class="s2"> is expected.&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;Data types types do not match. &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; in other is &quot;&quot;&quot;</span>
                               <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">. However, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">feats</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> is expected.&quot;&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f13b1293.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>